--- test: array indexing still works
#[10; 20; 30].[1]
--- expect: 20

--- test: string indexing still works
Byte.to_int ("hello".[0])
--- expect: 104

--- test: map indexing with string key
let m = #{"name": "alice"; "age": "30"}
in m.["name"]
--- expect: alice

--- test: map indexing with int key
let m = #{1: "one"; 2: "two"; 3: "three"}
in m.[2]
--- expect: two

--- test: map indexing expression key
let m = #{"x": 42}
let key = "x"
in m.[key]
--- expect: 42

--- test: map indexing chained with update
let m = #{"a": 1; "b": 2}
let m2 = #{ m with "a": 99 }
in m2.["a"]
--- expect: 99

--- test: array indexing variable
let arr = #[10; 20; 30]
in arr.[2]
--- expect: 30

--- test: nested map indexing
let outer = #{"inner": #{"val": 42}}
in outer.["inner"].["val"]
--- expect: 42

--- test: at function directly on array
at 1 #[10; 20; 30]
--- expect: 20

--- test: at function directly on map
at "x" #{"x": 99}
--- expect: 99

--- test: at function directly on string
Byte.to_int (at 0 "A")
--- expect: 65

--- test: map indexing in function
let lookup m k = m.[k]
in lookup #{"greeting": "hello"} "greeting"
--- expect: hello
